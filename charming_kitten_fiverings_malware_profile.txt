charming_kitten_fiverings_malware_profile.txt
md5: 21744F8876415EFF7EBF1C140BD729EA
The malware communicates with the following web service over TCP port 80:
info.services-mozilla.com





System Information Gathering
Once every 10 minutes, the malware executes the following commands to gather the current environment on the infected system:
cmd.exe /c mkdir C:\TEMP\SYSINFO\
cmd.exe /c quser >> C:\TEMP\SYSINFO\1-quser.txt
cmd.exe /c ipconfig /all >> C:\TEMP\SYSINFO\2-ipconfig-all.txt
cmd.exe /c netstat -ao >> C:\TEMP\SYSINFO\3-netstat-ao.txt
cmd.exe /c netstat -rs >> C:\TEMP\SYSINFO\4-netstat-rs.txt
cmd.exe /c net view >> C:\TEMP\SYSINFO\5-net-view.txt
cmd.exe /c net view /domain >> C:\TEMP\SYSINFO\6-net-view-domain.txt
cmd.exe /c nltest /trusted_domains >> C:\TEMP\SYSINFO\7-nltest-trusted-domains.txt
cmd.exe /c net localgroup administrators >> C:\TEMP\SYSINFO\8-net-localgroup-administrators.txt
cmd.exe /c net localgroup administrators /domain >> C:\TEMP\SYSINFO\9-net-localgroup-administrators-domain.txt
cmd.exe /c net localgroup users >> C:\TEMP\SYSINFO\10-net-localgroup-users.txt
cmd.exe /c net localgroup users /domain >> C:\TEMP\SYSINFO\11-net-localgroup-users-domain.txt
cmd.exe /c net localgroup IIS_IUSRS >> C:\TEMP\SYSINFO\12-net-localgroup-IIS_IUSRS.txt
cmd.exe /c net user /domain >> C:\TEMP\SYSINFO\13-net-user-domain.txt
cmd.exe /c net group /domain >> C:\TEMP\SYSINFO\14-net-group-domain.txt
cmd.exe /c net group \"domain admins\" /domain >> C:\TEMP\SYSINFO\15-net-group-domain-admins-domain.txt
cmd.exe /c net group \"domain computers\" /domain >> C:\TEMP\SYSINFO\16-net-group-domain-computers-domain.txt
cmd.exe /c net group \"enterprise admins\" /domain >> C:\TEMP\SYSINFO\17-net-group-enterprise-admins-domain.txt
cmd.exe /c net accounts >> C:\TEMP\SYSINFO\18-net-accounts.txt
cmd.exe /c net share >> C:\TEMP\SYSINFO\19-net-share.txt
cmd.exe /c net share /domain >> C:\TEMP\SYSINFO\20-net-share-domain.txt
cmd.exe /c route print >> C:\TEMP\SYSINFO\21-route-print.txt

The malware also executes the following commands to gather information on the infected system:
cmd.exe /c mkdir C:\TEMP\SYSINFO
cmd.exe /c attrib +H +S C:\TEMP\SYSINFO
cmd.exe /c date /t >> C:\TEMP\SYSINFO\SystemInfo.txt
cmd.exe /c time /t >> C:\TEMP\SYSINFO\SystemInfo.txt
cmd.exe /c systeminfo >> C:\TEMP\SYSINFO\SystemInfo.txt
cmd.exe /c reg export HKEY_CLASSES_ROOT C:\TEMP\SYSINFO\HKEY_CLASSES_ROOT
cmd.exe /c reg export HKEY_CURRENT_USER C:\TEMP\SYSINFO\HKEY_CURRENT_USER
cmd.exe /c reg export HKEY_LOCAL_MACHINE C:\TEMP\SYSINFO\HKEY_LOCAL_MACHINE
cmd.exe /c reg export HKEY_USERS C:\TEMP\SYSINFO\HKEY_USERS
cmd.exe /c reg export HKEY_CURRENT_CONFIG C:\TEMP\SYSINFO\REG\HKEY_CURRENT_CONFIG
cmd.exe /c wmic logicaldisk get size,freespace,status,caption,Description,DriveType > C:\TEMP\SYSINFO\Diskinfo.txt
cmd.exe /c gpresult /r /z > C:\TEMP\SYSINFO\GroupPolicy.txt
cmd.exe /c /c tasklist /v > C:\TEMP\SYSINFO\runapps.txt

Screenshot Capture
Once every minute, the malware takes a screenshot of the current desktop and saves the output at:
C:\TEMP\SYSINFO\cap_<timestamp>.png
If the screenshot size is larger than or equal to 1,048,577 bytes, the malware compresses the screenshot and saves the result at:
C:\TEMP\SYSINFO\F\c.png_<timestamp>.rar



Once every 10 minutes, the malware creates the following files within the C:\TEMP\SYSINFO directory:
1-quser.txt
1-quser_1.txt
2-ipconfig-all.txt
2-ipconfig-all_1.txt
3-netstat-ao.txt
3-netstat-ao_1.txt
4-netstat-rs.txt
4-netstat-rs_1.txt
5-net-view.txt
5-net-view_1.txt
6-net-view-domain.txt
6-net-view-domain_1.txt
7-nltest-trusted-domains.txt
7-nltest-trusted-domains_1.txt
8-net-localgroup-administrators.txt
8-net-localgroup-administrators_1.txt
9-net-localgroup-administrators-domain.txt
9-net-localgroup-administrators-domain_1.txt
10-net-localgroup-users.txt
10-net-localgroup-users_1.txt
11-net-localgroup-users-domain.txt
11-net-localgroup-users-domain_1.txt
12-net-localgroup-IIS_IUSRS.txt
12-net-localgroup-IIS_IUSRS_1.txt
13-net-user-domain.txt
13-net-user-domain_1.txt
14-net-group-domain.txt
14-net-group-domain_1.txt
15-net-group-domain-admins-domain.txt
15-net-group-domain-admins-domain_1.txt
16-net-group-domain-computers-domain.txt
16-net-group-domain-computers-domain_1.txt
17-net-group-enterprise-admins-domain.txt
17-net-group-enterprise-admins-domain_1.txt
18-net-accounts.txt
18-net-accounts_!.txt
19-net-share.txt
19-net-share_1.txt
20-net-share-domain.txt
20-net-share-domain_1.txt
21-route-print.txt
21-route-print_1.txt









Unique Strings
add_GetRaCompleted
remove_GetRaCompleted
add_getfiCompleted
remove_getfiCompleted
add_inokCompleted
remove_inokCompleted
OnGetRaOperationCompleted
OngetfiOperationCompleted
OninokOperationCompleted
rarsend
strfi
getfi
inok
onemin
tenmin
uploaderDnet.serv
uploaderDnet.My
a371084d-9eca-49fa-9ed0-80da1f84073e
1.0.0.0
http://tempuri.org/getfi
http://tempuri.org/T
http://tempuri.org/TU
http://tempuri.org/inok
http://tempuri.org/GetRa
http://tempuri.org/X
http://info.services-mozilla.com/WebService.asmx
C:\Users\Main\Desktop\uploaderDnet\uploaderDnet\obj\Release\uploaderDnet.pdb
uploaderDnet.Resources
uploaderDnet_serv_WebService
c:\temp\sysinfo\
yyyyMMddHHmmss
{0}cap_{1}.png
cap_{0}.png
cmd.exe
/c mkdir c:\temp\sysinfo
/c attrib +H +S c:\temp\sysinfo
/c date /t >> c:\temp\sysinfo\SystemInfo.txt
/c time /t >> c:\temp\sysinfo\SystemInfo.txt
/c systeminfo >> c:\temp\sysinfo\SystemInfo.txt
c:\temp\sysinfo\SystemInfo.txt
c:\temp\sysinfo\SystemInfo.cab
SystemInfo.rar
/c reg export HKEY_CURRENT_USER c:\temp\\sysinfo\HKEY_CURRENT_USER
c:\temp\sysinfo\HKEY_CURRENT_USER
c:\temp\sysinfo\HKEY_CURRENT_USER.cab
HKEY_CURRENT_USER.rar
/c reg export HKEY_CURRENT_CONFIG c:\temp\sysinfo\REG\HKEY_CURRENT_CONFIG
c:\temp\sysinfo\HKEY_CURRENT_CONFIG
c:\temp\sysinfo\HKEY_CURRENT_CONFIG.cab
HKEY_CURRENT_CONFIG.rar
/c C:\temp\sysinfo\rar.exe -m5 -inul -v1m a -r c:\temp\sysinfo\f\c.png_
.rar
C:\temp\sysinfo\f\
/c makecab
/c nltest /trusted_domains >> c:\temp\sysinfo\7-nltest-trusted-domains.txt
/c net localgroup administrators /domain >> c:\temp\sysinfo\9-net-localgroup-administrators-domain.txt
/c net localgroup users /domain >> c:\temp\sysinfo\11-net-localgroup-users-domain.txt
/c net group "domain admins" /domain >> c:\temp\sysinfo\15-net-group-domain-admins-domain.txt
/c net group "enterprise admins" /domain >> c:\temp\sysinfo\17-net-group-enterprise-admins-domain.txt
/c net accounts >> c:\temp\sysinfo\18-net-accounts.txt
/c net share >> c:\temp\sysinfo\19-net-share.txt
/c net share /domain >> c:\temp\sysinfo\20-net-share-domain.txt
/c route print >> c:\temp\sysinfo\21-route-print.txt
c:\temp\sysinfo\1-quser
quser
c:\temp\sysinfo\2-ipconfig-all
ipconfig-all
c:\temp\sysinfo\3-netstat-ao
netstat-ao
c:\temp\sysinfo\4-netstat-rs
netstat-rs
c:\temp\sysinfo\5-net-view
net-view
c:\temp\sysinfo\6-net-view-domain
net-view-domain
c:\temp\sysinfo\7-nltest-trusted-domains
nltest-trusted-domains
c:\temp\sysinfo\8-net-localgroup-administrators
net-localgroup-administrators
c:\temp\sysinfo\9-net-localgroup-administrators-domain
net-localgroup-administrators-domain
c:\temp\sysinfo\10-net-localgroup-users
net-localgroup-users
c:\temp\sysinfo\11-net-localgroup-users-domain
net-localgroup-users-domain
c:\temp\sysinfo\12-net-localgroup-IIS_IUSRS
net-localgroup-IIS_IUSRS
c:\temp\sysinfo\13-net-user-domain
net-user-domain
c:\temp\sysinfo\14-net-group-domain
net-group-domain
c:\temp\sysinfo\15-net-group-domain-admins-domain
net-group-domain-admins-domain
c:\temp\sysinfo\16-net-group-domain-computers-domain
net-group-domain-computers-domain
c:\temp\sysinfo\17-net-group-enterprise-admins-domain
net-group-enterprise-admins-domain
c:\temp\sysinfo\18-net-accounts
net-accounts
c:\temp\sysinfo\19-net-share
net-share
c:\temp\sysinfo\20-net-share-domain
net-share-domain
c:\temp\sysinfo\21-route-print
route-print
/c del c:\temp\sysinfo\HKEY_*
/c del c:\temp\sysinfo\*.cab
/c del c:\temp\sysinfo\*_1.txt
C:\temp\sysinfo\
getfi
inok
GetRa
uploaderDnet.exe
uploaderDnet
